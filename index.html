<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNCATOC: The Honda Civic Casefile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chosen Palette: Calm Neutral (Tailwind 'slate', 'sky', 'white') -->
    <!-- Application Structure Plan: A single-page dashboard with sticky top navigation ('Briefing', 'Dossiers', 'Analysis', 'Resolutions'). This structure logically guides the delegate from the core problem (Briefing) to the key players (Dossiers), the strategic landscape (Analysis), and the potential outcomes (Resolutions). The key interaction is an 'Ally Finder' filter in the Dossiers section, which provides immediate strategic value, making this an active tool, not a static report. -->
    <!-- Visualization & Content Choices: Report Info: Delegate Stances (Table IV) -> Goal: Compare delegate alignment on the core issue (jurisdiction) -> Viz: Horizontal Bar Chart (Chart.js) -> Interaction: None (static viz) -> Justification: Creates a scannable 'data' overview of the committee's leanings, fulfilling the Chart.js requirement by quantifying the qualitative stances. | Report Info: Delegate Stances (Table IV) -> Goal: Provide strategic grouping for delegates -> Viz: JS-powered 'Ally Finder' filter -> Interaction: User selects their role, JS highlights other delegates as 'Ally', 'Opponent', or 'Neutral' based on a pre-defined logic matrix -> Justification: This is the core interactive 'wow' factor, turning the report into a strategic tool. | Report Info: Key Terms (Table V) -> Goal: Inform -> Viz: HTML Definition List -> Interaction: None. | Report Info: Resolution Paths (Section VI) -> Goal: Inform/Organize -> Viz: 3-column HTML/Tailwind Card Grid -> Interaction: None. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 450px;
            max-height: 500px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 500px;
            }
        }
        
        .nav-link {
            @apply px-3 py-2 rounded-md text-sm font-medium text-slate-300 hover:bg-slate-700 hover:text-white transition-colors;
        }
        .nav-link.active {
            @apply bg-slate-900 text-white;
        }
        
        .delegate-card {
            @apply bg-white rounded-lg shadow-md hover:shadow-xl transition-all duration-300 cursor-pointer border-4 border-transparent;
        }
        
        .delegate-card.ally {
            @apply border-green-500 shadow-lg;
        }
        .delegate-card.opponent {
            @apply border-red-500 shadow-lg;
        }
        .delegate-card.neutral {
            @apply border-gray-400 shadow-lg;
        }

        .modal-backdrop {
            @apply fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 transition-opacity duration-300;
        }
        
        .modal-content {
            @apply bg-white rounded-lg shadow-xl p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto transform transition-all scale-95 opacity-0 duration-300;
        }
        
        .modal-backdrop.open {
            @apply opacity-100;
        }
        
        .modal-backdrop.open .modal-content {
            @apply scale-100 opacity-100;
        }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">

    <header class="bg-slate-800 text-white p-4 sticky top-0 z-40 shadow-md">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
            <h1 class="text-2xl font-bold text-center md:text-left">UNCATOC: The Honda Civic Casefile</h1>
            <nav id="navbar" class="flex flex-wrap justify-center space-x-2 md:space-x-4 mt-2 md:mt-0">
                <a href="#briefing" class="nav-link">Situation Briefing</a>
                <a href="#dossiers" class="nav-link">Delegate Dossiers</a>
                <a href="#analysis" class="nav-link">Strategic Analysis</a>
                <a href="#resolutions" class="nav-link">Resolution Paths</a>
            </nav>
        </div>
    </header>

    <main class="container mx-auto p-4 md:p-8">

        <section id="briefing" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-4 text-slate-900 border-b-2 border-slate-300 pb-2">Situation Briefing</h2>
            <p class="text-lg text-slate-600 mb-6">
                Welcome, delegates. This briefing provides the complete context for the case before us. It outlines the core legal mandate of this committee, the bizarre nature of the dispute, and the key theories surrounding the alleged incident. Understanding this foundation is critical before engaging with other delegates.
            </p>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow">
                    <h3 class="text-2xl font-semibold mb-3 text-slate-800">The Mandate vs. The Mystery</h3>
                    <p class="mb-4">This committee is convened under the serious mandate of the **United Nations Convention Against Transnational Organized Crime (UNCATOC)**. Our purpose is to combat major global crimes like drug trafficking, human smuggling, and illicit trade in firearms. The primary challenge is applying this serious legal framework to the current dispute.</p>
                    <p class="mb-4">The core legal thresholds for UNCATOC intervention are:</p>
                    <ul class="list-disc list-inside space-y-2 mb-4 pl-4">
                        <li><strong class="font-semibold">Organised Criminal Group:</strong> A structured group of three or more persons.</li>
                        <li><strong class="font-semibold">Serious Crime:</strong> An offence punishable by at least four years of liberty deprivation (hinges on the car's value).</li>
                        <li><strong class="font-semibold">Transnational Nature:</strong> Evidence the crime crossed borders (e.g., a smuggling ring).</li>
                    </ul>
                    <p class="mb-4">Delegates must decide if the absurdity of the claims outweighs the potential for a serious, transnational crime involving valuable assets.</p>
                    <p class="font-medium text-slate-700">This case revolves around "The Anonymous Facilitator" (the teacher), who allegedly confiscated M. Mert Apalı’s Honda Civic. The teacher and most students deny the event entirely, claiming to have "seen no Honda Civic in his/her life."</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow space-y-4">
                    <h3 class="text-2xl font-semibold mb-3 text-slate-800">Personal Dossier</h3>
                    <p class="text-sm"><strong>Subject: M. Mert Apalı</strong></p>
                    <p>Subject views his 1:57 scale JDM Honda Civic Type R (EK9) not as a toy, but as a <strong class="font-semibold text-sky-700">portable asset and highly valued memorabilia</strong>. His passion is tied to his disruptive behavior, as he frequently brings models to class for "emotional support." His established history of non-compliance is a major argument for the Defense Counsel.</p>
                </div>
            </div>

            <h3 class="text-2xl font-semibold mt-8 mb-4 text-slate-800">Three Competing Theories</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-sky-500">
                    <h4 class="text-xl font-bold mb-2">Apalı's Claim</h4>
                    <p class="text-sm">The car was a valuable <strong class="font-semibold">1:57 scale model</strong> and limited-edition "memorabilia." He believes the teacher recognized its value and stole it as part of a practiced, professional theft.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-red-500">
                    <h4 class="text-xl font-bold mb-2">The Denial</h4>
                    <p class="text-sm">The teacher and most students deny the event. The teacher claims to have <strong class="font-semibold">"seen no Honda Civic in his/her life."</strong> This suggests either a complete fabrication by Apalı or a highly coordinated cover-up.</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-yellow-500">
                    <h4 class="text-xl font-bold mb-2">The Beypınar Factor</h4>
                    <p class="text-sm">Apalı's friend, Mehmet Ali Beypınar, insists the car was a <strong class="font-semibold">full-sized, real vehicle.</strong> While logistically impossible, this is the only theory that automatically qualifies as a "Serious Crime" (grand theft auto).</p>
                </div>
            </div>
        </section>

        <section id="dossiers" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-4 text-slate-900 border-b-2 border-slate-300 pb-2">Delegate Dossiers</h2>
            <p class="text-lg text-slate-600 mb-6">
                Analyze the key stakeholders. Select your delegate from the dropdown to identify potential allies (green), opponents (red), and neutral parties (gray) based on their official stances. Click on any delegate card to read their full, detailed position.
            </p>
            
            <div class="mb-6 bg-white p-4 rounded-lg shadow sticky top-20 z-30">
                <label for="ally-finder" class="block text-sm font-medium text-slate-700 mb-2">Strategic Ally Finder: Select Your Role</label>
                <select id="ally-finder" class="w-full p-2 border border-slate-300 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500">
                    <option value="none">-- View All Neutrally --</option>
                </select>
            </div>

            <div id="delegate-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            </div>
        </section>

        <section id="analysis" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-4 text-slate-900 border-b-2 border-slate-300 pb-2">Strategic Analysis</h2>
            <p class="text-lg text-slate-600 mb-6">
                This section provides a visual overview of the committee's alignment and a glossary of key intelligence terms. Use this data to inform your strategic approach and understand the nuanced arguments at play.
            </p>

            <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
                <div class="lg:col-span-3 bg-white p-6 rounded-lg shadow">
                    <h3 class="text-2xl font-semibold mb-4 text-slate-800">Delegate Alignment on Intervention</h3>
                    <p class="text-sm text-slate-500 mb-4">This chart visualizes each delegate's general stance towards UNCATOC intervention in this case, from full dismissal to aggressive intervention.</p>
                    <div class="chart-container">
                        <canvas id="stanceChart"></canvas>
                    </div>
                </div>
                <div class="lg:col-span-2 bg-white p-6 rounded-lg shadow">
                    <h3 class="text-2xl font-semibold mb-4 text-slate-800">Key Intelligence Terms</h3>
                    <dl id="key-terms-list" class="divide-y divide-slate-200">
                    </dl>
                </div>
            </div>
        </section>

        <section id="resolutions" class="mb-12 scroll-mt-24">
            <h2 class="text-3xl font-bold mb-4 text-slate-900 border-b-2 border-slate-300 pb-2">Resolution Paths</h2>
            <p class="text-lg text-slate-600 mb-6">
                These are the three most likely outcomes for this committee. Your goal is to navigate the debate towards the path that best aligns with your delegate's core objectives.
            </p>

            <div id="resolutions-grid" class="grid grid-cols-1 md:grid-cols-3 gap-6">
            </div>
        </section>

    </main>

    <footer class="bg-slate-800 text-slate-300 text-center p-4 mt-12">
        <p class="text-sm">&copy; 2025 UNCATOC Special Committee | This is a fictional simulation for educational purposes.</p>
    </footer>

    <div id="modal-backdrop" class="modal-backdrop opacity-0 pointer-events-none">
        <div id="modal-content" class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modal-title" class="text-2xl font-bold"></h3>
                <button id="modal-close" class="text-slate-500 hover:text-slate-800 text-3xl">&times;</button>
            </div>
            <p id="modal-role" class="text-sm text-slate-500 font-medium mb-4 uppercase"></p>
            <p id="modal-stance" class="text-slate-700"></p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const delegateData = [
                { id: 1, name: 'M. Mert Apalı', entity: 'The Plaintiff/Victim', stance: 'The car (a valuable 1:57 scale memorabilia) was wrongfully confiscated and stolen by an organised criminal network disguised as a teacher. Demands full restitution and justice.', alignment: 10 },
                { id: 2, name: 'Counsel for the Teacher (Anonymous)', entity: 'Chief Defence Counsel', stance: 'The incident is imaginary. The teacher had the full right to confiscate a disruptive object, but the teacher maintains that no car was present. Apalı is engaging in defamation and harassment.', alignment: -10 },
                { id: 3, name: 'Mehmet Ali Beypınar', entity: 'Key Witness & Advocate', stance: 'The car *was* real (a full-sized prototype, definitely not a toy). The teacher’s denial is proof of a conspiracy. UNCATOC must intervene to recover the vehicle.', alignment: 9 },
                { id: 4, name: 'Interpol (Representative J. Jones)', entity: 'International Law Enforcement', stance: 'Highly sceptical of the "real car" theory. Focuses on investigating the potential of a high-value smuggling ring targeting rare model cars. The primary goal is establishing **jurisdiction**.', alignment: 3 },
                { id: 5, name: 'The Ministry of Education (Relevant State)', entity: 'Regulatory Authority', stance: 'Upholds the teacher’s right to maintain discipline. Views the affair as a trivial **domestic, educational matter** that UNCATOC has no business in. Calls for the immediate closure of the investigation.', alignment: -9 },
                { id: 6, name: 'Global Model Car Collectors Association (GMCCA) - Mr. Hans Bricker', entity: 'Specialist Expert Witness', stance: 'Provides valuation evidence. Argues that a specific, limited-edition 1:57 model *could* be high-value (>\$100,000), meeting the "serious crime" threshold. Demands its recovery as cultural property.', alignment: 8 },
                { id: 7, name: 'The Honda Motor Company Legal Team - Ms. Akari Tanaka', entity: 'Intellectual Property Holder', stance: 'Concerned with the unauthorised use of the "Honda Civic" trademark. Denies ever producing a high-value 1:57 model. Suggests Apalı\'s car was a cheap counterfeit, reducing the crime to petty theft.', alignment: -5 },
                { id: 8, name: 'UN Office on Drugs and Crime (UNODC) Secretariat - Mr. David Chen', entity: 'UNCATOC Procedure Expert', stance: 'Focuses purely on legal adherence to the Palermo Protocol. Insists on concrete, verifiable evidence that the act involved three or more people acting in concert **across borders**.', alignment: 0 },
                { id: 9, name: 'Delegate of Japan - Mr. Kenji Watanabe', entity: 'Concerned Member State', stance: 'Japan respects property rights and its national brands (Honda). Expresses deep concern over trademark use. Japan supports an investigation *only if* the GMCCA can definitively authenticate the model\'s value. Otherwise, views it as a simple, low-value disciplinary matter.', alignment: -2 },
                { id: 10, name: 'Delegate of the Russian Federation - Mr. Dimitri Volkov', entity: 'Concerned Member State', stance: 'Condemns the entire proceeding as an unprecedented overreach into the sovereign disciplinary affairs of a member state. There is no evidence of transnational activity. Demands immediate dismissal to prevent UNCATOC from becoming a \'school principal\'s office\'.', alignment: -8 },
                { id: 11, name: 'Delegate of Vatican City - Father Pietro Rossi', entity: 'Observer State (Moral Authority)', stance: 'Views the case as a moral crisis of truth, denial, and temptation. The organized crime is not the theft, but the **sin of covetousness** and the organized **lies** to cover a minor transgression. Calls for mediation and spiritual guidance for all parties.', alignment: 1 }
            ];

            const keyTermsData = [
                { term: 'Palermo Protocol', definition: 'The foundational treaty establishing UNCATOC\'s right to fight international crime.', significance: 'The central legal test: Does the Civic case meet its criteria?' },
                { term: '1:57 Scale', definition: 'The precise miniature size of the Civic, confirmed by Apalı.', significance: 'Crucial detail; its small size undermines the "Serious Crime" claim unless its monetary value is enormous.' },
                { term: 'Memorabilia/Asset', definition: 'Apalı’s legal term for the Civic, implying sentimental and financial value far beyond a "toy."', significance: 'Transforms the item from a toy into a potential "high-value cultural asset."' },
                { term: 'The Beypınar Factor', definition: 'The logical impossibility championed by Mehmet Ali Beypınar—the claim that the car was a full-sized vehicle.', significance: 'The most straightforward (yet absurd) path to fulfilling the **Serious Crime** criteria.' },
                { term: 'Organised Criminal Group', definition: 'Three or more persons acting in concert.', significance: 'The committee must identify the third member: Was it the Principal, the janitor, or another student?' },
                { term: 'The Anonymous Facilitator', definition: 'The alleged teacher and main perpetrator of the crime.', significance: 'The subject of the investigation; their anonymity highlights the challenge of identifying the criminal network.' }
            ];

            const resolutionData = [
                { title: 'The Interventionist Path', description: 'Pass a resolution invoking Article 3 of the Palermo Protocol. Mandate an international, Interpol-led retrieval operation for the Honda Civic, citing the potential for high-value organised crime and the breach of a student’s property rights.', details: '<strong>Requires proving the existence and high value of the asset.</strong><br/>Favored by: Apalı, Beypınar' },
                { title: 'The Disciplinary Path', description: 'Pass a resolution explicitly stating that UNCATOC has no jurisdiction. Reclassify the incident as a <strong>domestic educational/disciplinary matter</strong>, potentially handing over findings to a local school board or civil court.', details: '<strong>Requires demonstrating minimal asset value and a lack of organisation.</strong><br/>Favored by: Counsel' },
                { title: 'The Sceptical Path', description: 'Pass a resolution acknowledging the claims but delaying action due to insufficient evidence of a transnational criminal enterprise. Recommend a deep psychological analysis of Apalı and Beypınar to determine the veracity of their claims.', details: '<strong>Allows for further "investigation" without full intervention.</strong><br/>Favored by: Interpol' }
            ];
            
            const allyMatrix = {
                1: { 3: 'ally', 6: 'ally', 2: 'opponent', 5: 'opponent', 7: 'opponent', 10: 'opponent', 4: 'neutral', 8: 'neutral', 9: 'neutral', 11: 'neutral' },
                2: { 5: 'ally', 7: 'ally', 10: 'ally', 1: 'opponent', 3: 'opponent', 6: 'opponent', 4: 'neutral', 8: 'neutral', 9: 'neutral', 11: 'neutral' },
                3: { 1: 'ally', 6: 'ally', 2: 'opponent', 5: 'opponent', 7: 'opponent', 10: 'opponent', 4: 'neutral', 8: 'neutral', 9: 'neutral', 11: 'neutral' },
                4: { 8: 'ally', 9: 'ally', 1: 'neutral', 2: 'neutral', 3: 'neutral', 5: 'neutral', 6: 'neutral', 7: 'neutral', 10: 'neutral', 11: 'neutral' },
                5: { 2: 'ally', 7: 'ally', 9: 'ally', 10: 'ally', 1: 'opponent', 3: 'opponent', 6: 'opponent', 4: 'neutral', 8: 'neutral', 11: 'neutral' },
                6: { 1: 'ally', 3: 'ally', 2: 'opponent', 5: 'opponent', 7: 'opponent', 10: 'opponent', 4: 'neutral', 8: 'neutral', 9: 'neutral', 11: 'neutral' },
                7: { 2: 'ally', 5: 'ally', 9: 'ally', 10: 'ally', 1: 'opponent', 3: 'opponent', 6: 'opponent', 4: 'neutral', 8: 'neutral', 11: 'neutral' },
                8: { 4: 'ally', 9: 'ally', 11: 'neutral', 1: 'neutral', 2: 'neutral', 3: 'neutral', 5: 'neutral', 6: 'neutral', 7: 'neutral', 10: 'neutral' },
                9: { 5: 'ally', 7: 'ally', 8: 'ally', 10: 'ally', 1: 'neutral', 3: 'neutral', 6: 'neutral', 2: 'neutral', 4: 'neutral', 11: 'neutral' },
                10: { 2: 'ally', 5: 'ally', 7: 'ally', 9: 'ally', 1: 'opponent', 3: 'opponent', 6: 'opponent', 4: 'neutral', 8: 'neutral', 11: 'neutral' },
                11: { 8: 'ally', 1: 'neutral', 2: 'neutral', 3: 'neutral', 4: 'neutral', 5: 'neutral', 6: 'neutral', 7: 'neutral', 9: 'neutral', 10: 'neutral' }
            };

            const grid = document.getElementById('delegate-grid');
            const select = document.getElementById('ally-finder');
            const termsList = document.getElementById('key-terms-list');
            const resolutionsGrid = document.getElementById('resolutions-grid');
            const modalBackdrop = document.getElementById('modal-backdrop');
            const modalContent = document.getElementById('modal-content');
            const modalTitle = document.getElementById('modal-title');
            const modalRole = document.getElementById('modal-role');
            const modalStance = document.getElementById('modal-stance');
            const modalClose = document.getElementById('modal-close');

            function renderDelegates() {
                grid.innerHTML = '';
                delegateData.forEach(delegate => {
                    const card = document.createElement('div');
                    card.className = 'delegate-card p-4';
                    card.dataset.id = delegate.id;
                    const stanceSummary = delegate.stance.split('. ')[0] + '.'; 
                    card.innerHTML = `
                        <h3 class="text-lg font-semibold text-slate-900 mb-1">${delegate.name}</h3>
                        <p class="text-xs text-sky-700 font-medium uppercase tracking-wide mb-3">${delegate.entity}</p>
                        <div class="h-12 overflow-hidden mb-2">
                             <p class="text-sm text-slate-600">${stanceSummary.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')}</p>
                        </div>
                        <p class="text-xs mt-2 text-sky-500 font-semibold">Click for Full Stance</p>
                    `;
                    card.addEventListener('click', () => openModal(delegate));
                    grid.appendChild(card);
                    
                    const option = document.createElement('option');
                    option.value = delegate.id;
                    option.textContent = `${delegate.name} (${delegate.entity})`;
                    select.appendChild(option);
                });
            }

            function openModal(delegate) {
                modalTitle.textContent = delegate.name;
                modalRole.textContent = delegate.entity;
                modalStance.innerHTML = delegate.stance.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                modalBackdrop.classList.remove('pointer-events-none');
                modalBackdrop.classList.add('open');
            }

            function closeModal() {
                modalBackdrop.classList.remove('open');
                // Removed pointer-events-none for simpler transition cleanup
                setTimeout(() => {
                    modalBackdrop.classList.add('pointer-events-none');
                }, 300); // Waits for transition to finish
            }

            modalClose.addEventListener('click', closeModal);
            modalBackdrop.addEventListener('click', (e) => {
                // Ensure click is on the backdrop itself, not the content box
                if (e.target === modalBackdrop) {
                    closeModal();
                }
            });

            function updateAllyHighlighting() {
                // FIX: Ensure selectedId is an integer for lookup in the allyMatrix
                const selectedId = parseInt(select.value); 
                const cards = document.querySelectorAll('.delegate-card');
                
                cards.forEach(card => {
                    card.classList.remove('ally', 'opponent', 'neutral');
                    
                    // If 'none' selected or invalid ID, stop highlighting
                    if (isNaN(selectedId)) return; 

                    // FIX: Ensure cardId is an integer for lookup
                    const cardId = parseInt(card.dataset.id);
                    
                    if (cardId === selectedId) {
                        card.classList.add('neutral');
                        return;
                    }
                    
                    // allyMatrix[number][number] lookup now works reliably
                    const relationship = allyMatrix[selectedId] ? allyMatrix[selectedId][cardId] : null;
                    if (relationship) {
                        card.classList.add(relationship);
                    }
                });
            }
            
            select.addEventListener('change', updateAllyHighlighting);

            function renderKeyTerms() {
                termsList.innerHTML = '';
                keyTermsData.forEach(term => {
                    const item = document.createElement('div');
                    item.className = 'pt-4 pb-4';
                    item.innerHTML = `
                        <dt class="text-md font-semibold text-slate-800">${term.term}</dt>
                        <dd class="mt-1 text-sm text-slate-600">${term.definition}</dd>
                        <dd class="mt-1 text-xs text-sky-700 italic"><strong>Significance:</strong> ${term.significance.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')}</dd>
                    `;
                    termsList.appendChild(item);
                });
            }

            function renderResolutions() {
                resolutionsGrid.innerHTML = '';
                resolutionData.forEach(res => {
                    const card = document.createElement('div');
                    card.className = 'bg-white p-6 rounded-lg shadow-lg';
                    card.innerHTML = `
                        <h3 class="text-xl font-bold mb-3 text-slate-900">${res.title}</h3>
                        <p class="text-slate-600 mb-4">${res.description.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')}</p>
                        <div class="text-sm text-slate-500 bg-slate-50 p-3 rounded-md">${res.details.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')}</div>
                    `;
                    resolutionsGrid.appendChild(card);
                });
            }

            function renderStanceChart() {
                const ctx = document.getElementById('stanceChart').getContext('2d');
                const sortedData = [...delegateData].sort((a, b) => a.alignment - b.alignment);
                
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: sortedData.map(d => `${d.name} (${d.entity.substring(0, 15)}...)`),
                        datasets: [{
                            label: 'Stance on Intervention',
                            data: sortedData.map(d => d.alignment),
                            backgroundColor: sortedData.map(d => d.alignment > 0 ? 'rgba(56, 189, 248, 0.6)' : 'rgba(239, 68, 68, 0.6)'),
                            borderColor: sortedData.map(d => d.alignment > 0 ? 'rgba(56, 189, 248, 1)' : 'rgba(239, 68, 68, 1)'),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Dismiss Case <--- (Stance Score) ---> Full Intervention'
                                },
                                ticks: {
                                    display: true
                                },
                                grid: {
                                    display: true
                                }
                            },
                            y: {
                                ticks: {
                                    font: {
                                        size: 10
                                    }
                                },
                                grid: {
                                    display: false
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const delegate = sortedData[context.dataIndex];
                                        let label = `${delegate.name}: ${delegate.alignment}`;
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }
            
            function trackVisibleSection() {
                const sections = document.querySelectorAll('section');
                const navLinks = document.querySelectorAll('.nav-link');
                
                let currentSection = '';

                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting && entry.intersectionRatio >= 0.5) {
                            currentSection = entry.target.id;
                        }
                    });
                    
                    navLinks.forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === `#${currentSection}`) {
                            link.classList.add('active');
                        }
                    });
                }, { threshold: 0.5 });

                sections.forEach(section => observer.observe(section));
            }

            renderDelegates();
            renderKeyTerms();
            renderResolutions();
            renderStanceChart();
            trackVisibleSection();
        });
    </script>
</body>
</html>
